<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>RISD Unspoken</title>
  <meta name="description" content="RISD Unspoken messages">
  <link href="./favicon.png" rel="shortcut icon">

  <link rel="stylesheet" href="style.css">
  <script src="https://unpkg.com/prefixfree@1.0.0/prefixfree.min.js"></script>

  <script src="https://wzrd.in/standalone/formdata-polyfill@latest"></script>
  <script src="https://wzrd.in/standalone/promise-polyfill@latest"></script>
  <script src="https://wzrd.in/standalone/whatwg-fetch@latest"></script>
</head>
<body>

<div class="window">
<div class="bubble">

  <h1>Unspoken</h1>
  <div class="intro">
    <p>Unspoken is a project for graduating seniors who wants to leave any message that they were unable to speak during last four years. It can be memories from last four years or dark secret that you couldn’t tell anyone. This project is intended to leave any heavy burden off from the back or leave any happy memories during college year before you face your “adult world”.</p> 

    <p>All these messages will anonymously posted and only the writer will know about it. If you have any message that you want to leave behind, please scroll below and leave some words. 
    </p>

  </div>
</div>
</div>
  
  
<!--form-->
  <div class="window">
  <div class="bubble">
    <h1>Unspoken</h1>
    <p class="center explanation"> Leave your memories, or secrets behind.</p>
    
  <div class="form-container">
  <form name="submit-to-google-sheet"> 
  
  <p >Tell me your Story</p>
  <textarea name="story" type="text"></textarea>

  <p name = "">Where do you want to see your message? (cannot be your room)</p>
  <textarea name="place" type="text"> </textarea>
    
  <button type="submit" id="submit">submit</button> 
  
  <p class="confirmation">Information will kept anonymous and unknown.</p>
  </form>
  <div class="loading js-loading is-hidden">
      <div class="loading-spinner">
        <svg><circle cx="25" cy="25" r="20" fill="none" stroke-width="2" stroke-miterlimit="10"/></svg>
      </div>
    </div>
    
    <p class="js-success-message is-hidden">Thank you for the submission.</p>
    <p class="js-error-message is-hidden">Error, Please try again</p>
</div>
  </div>
</div>




<!--  <a href="https://docs.google.com/spreadsheets/d/1-KzY1rljP95rcLSbzm4uoxU43ZH2i1aLaRg_nVxT_sE/edit#gid=0" target="_blank">View the Google Sheet</a>-->
  
  <script>
    const scriptURL = 'https://script.google.com/macros/s/AKfycbzIMXyuL5sy2tppJFRWSkQDcU78zJmcHmfEw04jYiRHzKMQd8Fj/exec'
    const form = document.forms['submit-to-google-sheet']
    const loading = document.querySelector('.js-loading')
    const successMessage = document.querySelector('.js-success-message')
    const errorMessage = document.querySelector('.js-error-message')

    form.addEventListener('submit', e => {
      e.preventDefault()
      showLoadingIndicator()
      fetch(scriptURL, { method: 'POST', body: new FormData(form)})
        .then(response => showSuccessMessage(response))
        .catch(error => showErrorMessage(error))
    })

    function showLoadingIndicator () {
      form.classList.add('is-hidden')
      loading.classList.remove('is-hidden')
    }

    function showSuccessMessage (response) {
      console.log('Success!', response)
      setTimeout(() => {
        successMessage.classList.remove('is-hidden')
        loading.classList.add('is-hidden')
      }, 500)
    }

    function showErrorMessage (error) {
      console.error('Error!', error.message)
      setTimeout(() => {
        errorMessage.classList.remove('is-hidden')
        loading.classList.add('is-hidden')
      }, 500)
    }
  </script>

</body>
</html>
